
 * Author: Aristide Herve
 *
 * Created on November 29, 2024, 11:04 AM
 */


#include "xc.h"
#include "TIME_FCT.h"
#include "CONFIG_DSPIC33.h"  
#include "DSPIC_TFT.h"
#include "game.h"
/* Definition of Input/Output of commands of the de screen TFT*/

#define	TFT_CSX _RD10
#define	TFT_RSX _RD7
#define	TFT_DCX _RD9
#define	TFT_WRX _RD4
#define	TFT_RDX _RD5
#define	TFT_PWM _RD2

#define LCG_A 1664525
#define LCG_C 1013904223
#define LCG_M 4294967296

/* Definition of multiple basic colors primary colors (24 bits RGB colors) */

#define TFT_RED     0xFF,0x00,0x00
#define TFT_GREEN   0x00,0xFF,0x00
#define TFT_BLUE    0x00,0x00,0xFF
#define TFT_YELLOW  0xFF,0xFF,0x00
#define TFT_MAGENTA 0xFF,0x00,0xFF
#define TFT_CYAN    0x00,0xFF,0xFF
#define TFT_BLACK   0x00,0x00,0x00
#define TFT_WHITE   0xFF,0xFF,0xFF

#define TFT_ORANGE  0xED,0x7F,0x10
#define TFT_BROWN  0xCD,0x85,0x3F
#define TFT_BLUEE     0xD2, 0xDF, 0xF5


#define Ni_C 20 
#define Ni_L 15  

#define NB_LEFT_SQUARES 8
#define NB_RIGHT_SQUARES 8

/*Objects table declaration like the Perso, the Obstacle according to their pixels*/


char  square_black[768] = { 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90 };
char square_gray[768] = { 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90, 71, 69, 90 };
char Perso_D[768] = {246, 250, 252, 248, 251, 253, 255, 255, 255, 255, 255, 255, 235, 248, 240, 188, 192, 185, 171, 158, 161, 181, 173, 176, 176, 168, 172, 176, 162, 167, 208, 209, 207, 249, 255, 255, 255, 255, 255, 254, 250, 254, 250, 248, 254, 253, 251, 254, 232, 252, 246, 247, 255, 255, 253, 255, 252, 193, 168, 170, 122, 77, 77, 116, 40, 44, 119, 19, 29, 120, 27, 31, 118, 26, 31, 121, 25, 36, 118, 45, 54, 145, 101, 107, 218, 200, 203, 255, 255, 255, 252, 255, 255, 253, 244, 251, 255, 255, 255, 255, 255, 255, 156, 131, 137, 71, 3, 16, 142, 17, 32, 234, 65, 80, 248, 87, 90, 223, 88, 74, 223, 92, 79, 238, 88, 91, 206, 51, 65, 108, 0, 14, 80, 44, 51, 179, 193, 189, 255, 255, 255, 255, 255, 255, 255, 255, 255, 238, 241, 242, 127, 119, 126, 103, 58, 68, 199, 92, 100, 224, 63, 69, 249, 76, 80, 243, 86, 78, 239, 88, 80, 229, 75, 77, 211, 75, 77, 167, 78, 84, 105, 76, 84, 153, 163, 164, 255, 255, 255, 255, 255, 255, 255, 255, 255, 173, 176, 177, 46, 55, 53, 114, 123, 118, 212, 173, 174, 195, 75, 93, 204, 38, 65, 205, 30, 53, 206, 35, 58, 191, 41, 65, 204, 116, 130, 198, 163, 170, 91, 80, 84, 72, 76, 76, 221, 231, 230, 255, 255, 255, 255, 255, 255, 160, 156, 162, 40, 42, 43, 31, 47, 43, 82, 77, 82, 173, 114, 135, 198, 110, 132, 181, 98, 112, 187, 109, 122, 191, 116, 136, 148, 105, 126, 70, 67, 76, 7, 21, 18, 56, 67, 65, 195, 192, 196, 255, 255, 255, 255, 255, 255, 243, 235, 238, 117, 105, 110, 5, 3, 6, 43, 43, 48, 116, 102, 109, 132, 118, 115, 141, 148, 132, 135, 137, 123, 134, 113, 116, 103, 88, 101, 11, 14, 21, 14, 25, 23, 159, 169, 166, 255, 255, 255, 255, 255, 255, 255, 255, 248, 255, 255, 255, 242, 243, 246, 104, 105, 106, 111, 110, 104, 200, 180, 167, 213, 184, 161, 226, 203, 165, 211, 176, 144, 234, 190, 175, 171, 150, 143, 97, 96, 93, 144, 144, 147, 255, 255, 255, 255, 255, 255, 251, 252, 248, 248, 252, 246, 251, 254, 250, 255, 255, 255, 228, 231, 233, 98, 93, 95, 89, 51, 49, 201, 142, 126, 231, 181, 148, 229, 180, 149, 162, 108, 95, 71, 41, 42, 141, 141, 143, 255, 255, 255, 255, 255, 255, 247, 249, 249, 244, 246, 247, 245, 250, 245, 255, 255, 255, 252, 252, 249, 203, 205, 203, 180, 170, 181, 155, 103, 126, 110, 27, 41, 84, 15, 12, 66, 12, 6, 99, 48, 56, 162, 132, 153, 186, 181, 192, 222, 222, 219, 255, 255, 255, 251, 255, 255, 243, 249, 250, 255, 255, 255, 234, 232, 226, 180, 172, 164, 126, 119, 105, 120, 105, 87, 170, 114, 103, 179, 93, 91, 153, 93, 82, 149, 121, 100, 165, 138, 121, 145, 126, 109, 113, 102, 85, 139, 129, 115, 202, 197, 188, 238, 241, 238, 255, 255, 255, 255, 255, 255, 171, 163, 159, 106, 90, 78, 140, 122, 98, 97, 82, 55, 91, 42, 35, 161, 80, 96, 183, 135, 148, 130, 125, 128, 66, 58, 53, 60, 45, 25, 135, 117, 89, 124, 103, 83, 120, 107, 94, 205, 204, 196, 255, 255, 255, 255, 255, 255, 250, 250, 248, 209, 203, 192, 186, 181, 164, 130, 119, 113, 98, 68, 88, 108, 71, 111, 32, 17, 60, 0, 5, 37, 26, 42, 62, 84, 84, 89, 163, 148, 146, 208, 194, 192, 212, 210, 205, 255, 255, 255, 255, 255, 250, 251, 250, 244, 254, 254, 248, 255, 255, 255, 255, 255, 254, 113, 109, 109, 0, 0, 0, 47, 32, 53, 125, 121, 144, 104, 118, 141, 0, 4, 22, 6, 13, 28, 160, 156, 162, 255, 255, 255, 255, 255, 255, 245, 254, 253, 247, 254, 252, 254, 252, 246, 249, 251, 245, 254, 255, 255, 255, 255, 255, 176, 181, 188, 45, 44, 53, 111, 107, 110, 255, 255, 255, 222, 225, 219, 71, 72, 65, 100, 98, 95, 234, 231, 231, 255, 255, 255, 249, 255, 255, 239, 254, 254, 241, 254, 254, 242, 251, 254, 246, 251, 253, 249, 246, 242, 248, 241, 234, 247, 246, 243, 254, 255, 255, 255, 255, 240, 234, 205, 180, 199, 142, 109, 187, 125, 87, 186, 127, 78, 202, 159, 127, 235, 216, 211, 255, 255, 255, 248, 255, 253, 245, 252, 253};
char fallingObject [768] = {
85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,0,0,0,0,0,0,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,0,0,0,0,0,0,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,255,255,255,255,255,255,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,255,255,255,255,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,0,0,0,0,0,0,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,0,0,0,0,0,0,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,0,0,0,0,0,0,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,255,255,255,255,255,255,85,255,255,85,255,255,85,255,255,85,255,255,255,255,255,255,255,255,255,255,255,255,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,85,255,255,
};
    
 int verdure[768] = { 0, 198, 141, 0, 199, 135, 0, 198, 133, 0, 198, 132, 0, 198, 129, 0, 198, 124, 0, 198, 122, 29, 199, 120, 47, 198, 118, 117, 176, 95, 91, 114, 51, 28, 162, 119, 25, 184, 111, 28, 193, 106, 16, 185, 104, 0, 170, 105, 116, 202, 42, 117, 198, 41, 120, 200, 41, 116, 202, 41, 116, 201, 41, 116, 200, 41, 110, 198, 41, 107, 195, 41, 119, 196, 40, 123, 191, 37, 130, 194, 36, 127, 197, 40, 123, 196, 39, 124, 198, 39, 126, 197, 39, 129, 197, 39, 120, 197, 38, 121, 196, 37, 121, 196, 37, 117, 196, 37, 116, 194, 37, 112, 192, 37, 107, 192, 37, 104, 190, 37, 112, 192, 37, 115, 192, 36, 108, 185, 35, 117, 192, 36, 119, 193, 36, 118, 194, 36, 116, 194, 37, 115, 192, 37, 122, 200, 39, 122, 199, 38, 120, 200, 39, 118, 198, 39, 115, 195, 37, 117, 196, 37, 113, 191, 36, 111, 190, 36, 121, 190, 35, 119, 197, 37, 117, 192, 36, 123, 195, 36, 120, 193, 36, 117, 194, 37, 116, 196, 37, 114, 196, 38, 102, 181, 35, 101, 181, 35, 104, 184, 35, 103, 185, 35, 98, 183, 35, 99, 184, 35, 98, 182, 35, 106, 184, 35, 104, 182, 35, 105, 181, 34, 110, 181, 34, 104, 181, 35, 107, 185, 35, 105, 187, 36, 102, 185, 35, 100, 182, 35, 104, 179, 34, 111, 182, 34, 117, 187, 35, 108, 185, 35, 102, 182, 35, 103, 183, 35, 110, 184, 35, 113, 186, 35, 111, 184, 35, 115, 190, 36, 120, 188, 35, 117, 189, 35, 113, 188, 35, 108, 185, 35, 105, 185, 35, 105, 185, 35, 109, 181, 34, 109, 181, 34, 111, 182, 34, 107, 182, 35, 100, 180, 35, 110, 184, 35, 112, 185, 35, 111, 183, 34, 116, 187, 35, 117, 188, 35, 115, 185, 35, 118, 185, 34, 115, 185, 35, 115, 185, 35, 114, 185, 35, 113, 185, 35, 109, 179, 34, 108, 179, 34, 110, 179, 33, 106, 177, 33, 97, 176, 34, 101, 177, 34, 108, 179, 34, 109, 180, 34, 108, 181, 34, 110, 182, 35, 115, 185, 35, 114, 182, 34, 116, 187, 35, 117, 186, 35, 116, 185, 35, 121, 186, 34, 116, 186, 35, 115, 185, 35, 115, 184, 35, 116, 185, 35, 113, 186, 35, 110, 183, 35, 115, 185, 35, 114, 185, 35, 107, 181, 35, 106, 180, 34, 110, 182, 34, 106, 182, 35, 105, 184, 35, 113, 185, 35, 115, 185, 35, 116, 185, 35, 104, 179, 34, 106, 182, 35, 110, 183, 35, 110, 183, 35, 115, 185, 35, 114, 184, 34, 111, 184, 35, 109, 181, 34, 103, 182, 35, 107, 184, 35, 110, 185, 35, 103, 181, 35, 100, 180, 35, 109, 183, 35, 107, 180, 34, 110, 183, 34, 97, 173, 33, 97, 176, 33, 102, 177, 34, 102, 174, 33, 107, 173, 31, 103, 171, 31, 97, 173, 32, 98, 172, 32, 94, 176, 34, 98, 175, 34, 100, 175, 33, 89, 170, 33, 97, 173, 33, 100, 175, 33, 94, 173, 33, 97, 172, 32, 91, 164, 30, 89, 164, 31, 87, 161, 30, 88, 160, 29, 94, 160, 28, 86, 159, 29, 80, 157, 29, 85, 157, 29, 79, 155, 29, 79, 157, 29, 76, 154, 29, 71, 154, 29, 77, 154, 29, 75, 152, 28, 68, 149, 28, 70, 150, 28, 72, 148, 28, 78, 150, 28, 82, 150, 28, 79, 151, 28, 77, 148, 27, 74, 147, 27, 70, 144, 26, 74, 144, 26, 74, 145, 27, 72, 146, 27, 72, 144, 27, 69, 145, 27, 66, 145, 27, 67, 144, 27, 67, 142, 26, 65, 141, 26, 64, 136, 25, 67, 136, 24, 69, 136, 24, 65, 137, 25, 69, 139, 25, 74, 138, 24, 69, 135, 24, 66, 135, 24, 71, 140, 25, 73, 142, 26, 66, 138, 25, 67, 139, 25, 63, 139, 26, 66, 141, 26, 68, 141, 25, 65, 140, 25, 60, 129, 23, 60, 128, 22, 63, 130, 23, 58, 129, 23, 55, 126, 22, 53, 127, 22, 50, 122, 22, 59, 124, 22, 63, 125, 22, 52, 127, 23, 54, 125, 22, 56, 126, 22, 48, 125, 22, 48, 125, 22, 53, 125, 22, 54, 125, 22, 62, 132, 23, 65, 132, 23, 63, 129, 22, 64, 131, 23, 70, 133, 23, 63, 132, 23, 67, 131, 23, 63, 133, 24, 72, 136, 24, 62, 135, 24, 63, 133, 24, 61, 130, 23, 60, 131, 23, 64, 130, 23, 66, 130, 23, 66, 130, 23 };
 char clean_Perso [768]={255};
 char pizza[768]={255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 0, 255, 255, 0, 253, 240, 0, 230, 187, 0, 225, 171, 0, 225, 176, 12, 238, 191, 38, 237, 189, 60, 231, 173, 57, 243, 199, 43, 230, 190, 23, 221, 163, 0, 222, 149, 0, 244, 206, 0, 255, 255, 0, 255, 255, 0, 255, 255, 0, 255, 255, 0, 252, 229, 1, 240, 177, 42, 248, 211, 87, 252, 218, 109, 211, 79, 87, 226, 133, 92, 195, 228, 73, 215, 153, 87, 234, 140, 95, 245, 201, 88, 231, 158, 38, 238, 198, 0, 255, 255, 0, 255, 255, 0, 246, 220, 0, 245, 210, 4, 210, 175, 45, 214, 181, 90, 250, 195, 109, 251, 228, 111, 247, 187, 123, 253, 199, 103, 255, 243, 109, 234, 168, 107, 227, 144, 84, 254, 232, 113, 253, 233, 129, 248, 204, 79, 222, 170, 5, 214, 176, 0, 220, 146, 0, 245, 171, 57, 227, 231, 124, 205, 175, 92, 204, 60, 62, 250, 218, 133, 231, 255, 117, 211, 215, 86, 255, 234, 123, 233, 159, 85, 236, 181, 90, 255, 237, 104, 236, 176, 137, 228, 144, 105, 238, 183, 68, 200, 157, 0, 215, 151, 17, 247, 196, 89, 253, 227, 132, 255, 239, 124, 255, 250, 101, 229, 136, 86, 208, 124, 66, 236, 225, 99, 250, 213, 111, 218, 121, 67, 233, 157, 98, 245, 253, 131, 213, 144, 64, 228, 136, 92, 255, 218, 105, 225, 167, 31, 231, 174, 42, 255, 227, 104, 230, 159, 85, 205, 84, 80, 251, 238, 124, 216, 140, 75, 237, 166, 97, 242, 208, 105, 193, 64, 62, 234, 194, 101, 255, 255, 118, 222, 208, 93, 223, 224, 87, 255, 247, 117, 248, 218, 118, 237, 172, 55, 234, 173, 25, 246, 204, 98, 255, 224, 105, 251, 195, 129, 226, 220, 123, 198, 225, 58, 245, 197, 110, 234, 181, 124, 252, 226, 86, 235, 183, 114, 228, 171, 98, 215, 243, 77, 220, 160, 86, 206, 74, 73, 246, 197, 99, 225, 174, 29, 232, 166, 3, 248, 196, 79, 226, 192, 95, 194, 106, 65, 251, 199, 94, 255, 241, 112, 214, 106, 70, 220, 125, 76, 255, 255, 142, 224, 136, 88, 216, 112, 75, 213, 179, 72, 228, 169, 90, 254, 219, 113, 249, 195, 78, 235, 185, 2, 222, 149, 0, 251, 180, 18, 236, 199, 72, 227, 209, 101, 208, 84, 72, 216, 143, 91, 255, 255, 114, 255, 247, 123, 236, 194, 128, 250, 213, 99, 255, 255, 116, 219, 128, 104, 220, 111, 87, 254, 225, 102, 209, 129, 28, 204, 93, 0, 66, 53, 0, 29, 27, 0, 150, 114, 10, 255, 208, 66, 245, 197, 100, 196, 196, 85, 247, 236, 110, 249, 226, 120, 208, 93, 84, 233, 118, 95, 206, 218, 87, 210, 206, 91, 254, 197, 78, 225, 169, 15, 227, 224, 0, 219, 222, 0, 0, 0, 0, 0, 0, 0, 119, 99, 0, 255, 202, 0, 224, 169, 12, 238, 178, 48, 243, 189, 68, 241, 195, 74, 239, 190, 75, 238, 186, 66, 241, 181, 49, 227, 166, 18, 219, 174, 0, 216, 174, 0, 251, 247, 0, 255, 255, 0, 0, 0, 0, 0, 0, 0, 120, 98, 0, 255, 208, 0, 212, 163, 0, 225, 162, 10, 235, 172, 29, 233, 180, 52, 239, 197, 57, 236, 195, 34, 236, 174, 13, 219, 167, 3, 218, 177, 0, 218, 175, 0, 252, 248, 0, 255, 255, 0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255};
 char ananas[768]={119, 185, 233, 111, 189, 225, 108, 191, 243, 97, 179, 237, 114, 198, 242, 96, 177, 230, 141, 200, 255, 79, 109, 143, 82, 139, 184, 135, 211, 227, 106, 189, 255, 98, 185, 239, 117, 193, 253, 116, 185, 244, 116, 179, 255, 115, 185, 236, 100, 196, 234, 120, 185, 249, 113, 182, 255, 106, 187, 250, 116, 197, 250, 123, 212, 255, 112, 182, 233, 80, 95, 92, 67, 111, 120, 140, 192, 249, 124, 191, 255, 110, 191, 244, 100, 182, 222, 116, 194, 240, 100, 191, 196, 107, 197, 250, 89, 194, 239, 124, 195, 215, 108, 182, 231, 106, 188, 238, 97, 166, 182, 117, 193, 243, 94, 161, 190, 151, 167, 69, 78, 110, 63, 116, 144, 217, 77, 133, 158, 102, 169, 214, 143, 215, 255, 116, 194, 243, 107, 198, 251, 82, 191, 211, 108, 189, 234, 105, 182, 208, 128, 205, 255, 128, 196, 233, 45, 93, 81, 86, 128, 144, 106, 143, 152, 85, 105, 6, 84, 99, 70, 153, 187, 110, 54, 110, 3, 67, 106, 165, 119, 160, 240, 102, 163, 194, 135, 208, 255, 106, 197, 252, 123, 187, 225, 107, 190, 234, 113, 173, 233, 137, 160, 254, 106, 130, 204, 84, 113, 83, 91, 105, 30, 51, 54, 37, 135, 156, 65, 123, 163, 12, 55, 85, 33, 95, 126, 82, 48, 74, 63, 83, 111, 151, 125, 174, 207, 107, 168, 223, 116, 184, 229, 127, 206, 255, 55, 98, 117, 54, 75, 19, 145, 189, 164, 101, 131, 142, 79, 76, 43, 109, 116, 21, 109, 140, 13, 47, 79, 0, 74, 94, 66, 142, 168, 79, 110, 130, 59, 86, 116, 44, 48, 95, 51, 117, 165, 239, 111, 191, 224, 127, 209, 255, 93, 139, 189, 57, 92, 12, 103, 169, 0, 123, 177, 63, 104, 120, 84, 72, 84, 46, 73, 106, 0, 54, 73, 53, 134, 159, 101, 131, 162, 45, 102, 131, 25, 65, 102, 32, 68, 119, 138, 131, 200, 242, 109, 192, 226, 95, 184, 224, 128, 199, 255, 112, 151, 208, 64, 97, 80, 74, 116, 30, 71, 116, 23, 65, 106, 36, 38, 52, 55, 79, 109, 39, 107, 147, 12, 77, 107, 17, 71, 103, 30, 84, 122, 133, 134, 195, 255, 108, 196, 255, 108, 184, 220, 114, 184, 244, 114, 191, 233, 112, 216, 255, 89, 187, 248, 110, 139, 179, 129, 111, 127, 97, 106, 53, 117, 111, 75, 123, 146, 102, 110, 104, 68, 76, 94, 132, 102, 186, 255, 128, 214, 255, 108, 183, 250, 112, 192, 225, 109, 196, 224, 118, 178, 228, 119, 202, 252, 93, 181, 245, 130, 143, 151, 229, 176, 48, 245, 195, 62, 183, 156, 139, 230, 171, 101, 255, 222, 104, 225, 179, 102, 198, 146, 109, 113, 132, 130, 95, 182, 236, 118, 195, 247, 112, 185, 220, 113, 175, 222, 106, 205, 246, 81, 167, 250, 136, 142, 132, 255, 194, 51, 203, 138, 56, 164, 119, 77, 255, 215, 57, 195, 188, 81, 146, 111, 71, 213, 192, 109, 248, 218, 70, 106, 81, 61, 73, 120, 202, 128, 213, 254, 106, 189, 243, 106, 202, 227, 95, 187, 255, 123, 155, 206, 156, 117, 60, 195, 142, 76, 209, 182, 91, 227, 209, 81, 138, 101, 74, 168, 150, 68, 238, 208, 98, 199, 159, 71, 176, 145, 62, 248, 200, 72, 137, 116, 95, 84, 152, 255, 102, 210, 239, 104, 200, 242, 105, 202, 255, 98, 127, 185, 169, 128, 62, 255, 213, 104, 170, 133, 88, 159, 130, 74, 252, 228, 138, 197, 174, 58, 172, 124, 58, 221, 166, 110, 221, 183, 86, 208, 152, 13, 127, 101, 52, 104, 171, 242, 97, 193, 231, 107, 180, 215, 104, 205, 255, 96, 180, 252, 103, 100, 93, 216, 139, 31, 255, 203, 89, 218, 183, 93, 166, 114, 30, 189, 159, 86, 255, 236, 101, 218, 183, 89, 198, 139, 73, 145, 110, 54, 87, 127, 139, 117, 184, 237, 123, 186, 253, 97, 194, 236, 117, 182, 222, 122, 200, 249, 87, 164, 218, 115, 118, 99, 169, 106, 9, 168, 115, 37, 170, 157, 123, 226, 171, 70, 182, 131, 22, 172, 124, 42, 193, 143, 84, 113, 125, 137, 109, 188, 255, 129, 201, 255, 118, 185, 240, 105, 195, 232, 109, 185, 247, 117, 190, 223, 109, 199, 249, 87, 170, 236, 110, 134, 172, 130, 116, 139, 137, 153, 140, 158, 166, 129, 81, 105, 141, 103, 96, 148, 121, 151, 211, 100, 201, 253, 100, 206, 230, 99, 193, 231, 95, 188, 229};
 char argent[768]={255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 242, 254, 252, 154, 248, 236, 73, 242, 222, 56, 241, 222, 54, 247, 234, 70, 253, 252, 156, 255, 255, 240, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 254, 171, 246, 224, 27, 233, 189, 0, 228, 166, 0, 226, 161, 0, 226, 161, 0, 232, 171, 0, 239, 196, 0, 246, 225, 20, 252, 249, 162, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 254, 255, 255, 253, 250, 135, 238, 204, 0, 223, 158, 0, 228, 150, 6, 233, 154, 7, 238, 162, 8, 238, 162, 9, 234, 155, 6, 232, 153, 4, 234, 168, 0, 244, 208, 0, 251, 246, 130, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 178, 237, 206, 0, 219, 145, 6, 234, 155, 5, 240, 169, 7, 237, 167, 5, 236, 164, 16, 236, 165, 17, 236, 166, 5, 237, 167, 8, 235, 155, 7, 234, 159, 0, 245, 211, 0, 252, 251, 175, 255, 255, 255, 255, 255, 244, 245, 225, 26, 222, 157, 0, 235, 156, 7, 238, 169, 8, 235, 165, 6, 233, 155, 5, 242, 185, 10, 238, 178, 10, 233, 157, 6, 236, 166, 6, 236, 167, 7, 234, 156, 8, 238, 170, 0, 248, 226, 21, 254, 255, 244, 255, 255, 195, 232, 191, 0, 227, 148, 0, 240, 169, 6, 235, 166, 11, 236, 164, 17, 241, 182, 11, 237, 199, 18, 244, 211, 18, 240, 191, 12, 234, 161, 17, 237, 167, 11, 236, 166, 7, 233, 155, 1, 242, 196, 0, 253, 252, 174, 249, 240, 96, 230, 172, 0, 233, 153, 2, 237, 167, 7, 235, 165, 10, 239, 171, 15, 246, 211, 19, 226, 157, 0, 237, 171, 0, 238, 192, 14, 233, 161, 14, 237, 167, 10, 236, 166, 7, 233, 155, 2, 239, 180, 0, 250, 239, 79, 243, 223, 45, 226, 160, 0, 237, 163, 15, 236, 167, 11, 236, 165, 7, 234, 160, 3, 240, 189, 12, 250, 221, 54, 243, 204, 54, 236, 167, 13, 236, 162, 3, 236, 166, 7, 236, 166, 9, 235, 163, 14, 237, 169, 0, 248, 223, 33, 242, 223, 53, 224, 159, 0, 238, 166, 17, 236, 167, 12, 236, 165, 7, 237, 166, 4, 235, 169, 8, 237, 185, 62, 245, 215, 78, 246, 205, 25, 234, 161, 3, 236, 165, 7, 236, 166, 10, 235, 165, 17, 236, 167, 0, 248, 221, 34, 245, 230, 58, 232, 170, 0, 235, 157, 3, 236, 166, 7, 235, 163, 8, 238, 169, 9, 249, 218, 16, 236, 170, 0, 240, 170, 0, 245, 210, 19, 233, 164, 10, 237, 165, 7, 236, 166, 7, 234, 156, 3, 240, 176, 0, 249, 230, 43, 252, 249, 134, 237, 187, 0, 231, 152, 4, 237, 167, 8, 236, 165, 11, 236, 167, 13, 240, 191, 11, 246, 213, 16, 243, 209, 17, 232, 174, 13, 234, 162, 14, 236, 167, 11, 236, 166, 7, 234, 154, 6, 241, 189, 0, 252, 245, 118, 255, 255, 230, 243, 214, 0, 232, 160, 0, 236, 160, 6, 236, 167, 9, 236, 167, 9, 231, 152, 7, 237, 181, 10, 232, 176, 11, 232, 152, 6, 237, 167, 9, 236, 167, 10, 234, 156, 0, 235, 159, 0, 245, 214, 0, 253, 255, 223, 255, 255, 255, 251, 244, 115, 241, 196, 0, 233, 152, 8, 235, 161, 6, 236, 167, 8, 237, 166, 5, 235, 166, 16, 236, 165, 16, 237, 166, 4, 236, 167, 8, 235, 158, 2, 236, 166, 44, 244, 208, 37, 250, 243, 114, 254, 255, 255, 255, 255, 255, 255, 255, 255, 250, 237, 73, 241, 192, 0, 235, 159, 0, 233, 154, 6, 235, 161, 5, 236, 167, 15, 237, 168, 16, 235, 161, 5, 234, 154, 6, 234, 156, 0, 244, 201, 1, 251, 243, 93, 253, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 253, 255, 248, 250, 240, 86, 245, 206, 0, 240, 179, 0, 236, 166, 8, 234, 159, 6, 234, 159, 4, 237, 166, 11, 239, 180, 0, 243, 205, 0, 249, 233, 58, 254, 251, 223, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 254, 255, 255, 251, 249, 166, 249, 236, 66, 245, 214, 12, 245, 207, 13, 245, 207, 14, 247, 214, 10, 250, 235, 63, 252, 249, 161, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255};
char bombe [768] = {30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,7,31,0,7,31,0,0,98,0,0,98,143,127,143,143,127,143,0,7,31,0,7,31,254,253,255,254,253,255,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,7,31,0,0,98,0,0,98,0,0,98,254,253,255,254,253,255,0,7,31,254,253,255,254,253,255,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,0,98,64,72,176,64,72,176,0,0,98,143,127,143,109,102,109,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,0,7,31,0,0,98,64,72,176,31,144,255,31,144,255,0,0,98,109,102,109,109,102,109,143,127,143,143,127,143,109,102,109,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,0,7,31,0,0,98,31,144,255,254,253,255,31,144,255,64,72,176,0,0,98,143,127,143,143,127,143,109,102,109,0,7,31,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,0,7,31,0,0,98,31,144,255,254,253,255,31,144,255,64,72,176,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,30,104,0,30,104,0,0,7,31,0,0,98,64,72,176,31,144,255,31,144,255,64,72,176,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,30,104,0,30,104,0,0,7,31,0,0,98,64,72,176,31,144,255,31,144,255,64,72,176,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,30,104,0,30,104,0,0,7,31,0,0,98,0,0,98,64,72,176,64,72,176,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,0,7,31,0,7,31,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,0,7,31,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,7,31,0,7,31,0,0,98,0,0,98,0,0,98,0,0,98,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,0,7,31,30,104,0,30,104,0,30,104,0,30,104,0,30,104,0};
 
 /*Position of the main character initialization*/
 
 unsigned long seed = 12345;
 
 int time = 0;
 int Perso_x = 10; // Initial line of du personnage
 int Perso_y = 14; // Position sur la ligne inférieure
 int fallingObject_x =5; // Position aléatoire du premier objet tombant
 int fallingObject_y = 0; // L'objet commence en haut de l'écran

 
 int fallingObject_type = -1; // -1 means no object assigned yet

 int score = 0; // Score initial
 
 /*useful functions declaration*/
void srand_custom(unsigned long init_seed) {
    seed = init_seed;
}

unsigned int rand_custom() {
    seed = (LCG_A * seed + LCG_C) % LCG_M; // Appliquer la formule LCG
    return (unsigned int)(seed & 0xFFFF);  // Retourner un nombre sur 16 bits
}

// Fonction pour générer un nombre dans une plage donnée [min, max] differente de 1
unsigned int rand_range(unsigned int min, unsigned int max) {
    return min + (rand_custom() % (max - min + 1));
}   

void init_game() {
    Perso_x = 10; // Positionnement initial du personnage
    Perso_y = 14; // Position sur la ligne inférieure
    fallingObject_x =rand_range(1,19); // Position aléatoire du premier objet tombant
    fallingObject_y = 0; // L'objet commence en haut de l'écran
    score = 0; // Score initial 
    time=0;
}



typedef struct {
    int x;
    int y;
} Square;

// Exemple d'initialisation pour la bande de gauche (x fixe à 4) pour 8 carrés noirs et 8 autres gris alternés
Square leftBlackSquares[NB_LEFT_SQUARES] = {
    {4, 0}, {4, 2}, {4, 4}, {4, 6},
    {4, 8}, {4, 10}, {4, 12}, {4, 14}
};

Square leftGraySquares[NB_LEFT_SQUARES] = {
    {4, 1}, {4, 3}, {4, 5}, {4, 7},
    {4, 9}, {4, 11}, {4, 13}, {4, 15}
};

// Exemple d'initialisation pour la bande de droite (x fixe à 15)
Square rightBlackSquares[NB_RIGHT_SQUARES] = {
    {15, 0}, {15, 2}, {15, 4}, {15, 6},
    {15, 8}, {15, 10}, {15, 12}, {15, 14}
};

Square rightGraySquares[NB_RIGHT_SQUARES] = {
    {15, 1}, {15, 3}, {15, 5}, {15, 7},
    {15, 9}, {15, 11}, {15, 13}, {15, 15}
};

void scrolling_back(void) {
    int i;
    for (i = 0; i < NB_LEFT_SQUARES; i++) {
        leftBlackSquares[i].y = (leftBlackSquares[i].y + 1) % 16;
        leftGraySquares[i].y = (leftGraySquares[i].y + 1) % 16;
    }

    for (i = 0; i < NB_RIGHT_SQUARES; i++) {
        rightBlackSquares[i].y = (rightBlackSquares[i].y + 1) % 16;
        rightGraySquares[i].y = (rightGraySquares[i].y + 1) % 16;
    }
}
void tft_texture_background(void) {
    int i;
    // Affichage de la bande de gauche
    for (i = 0; i < NB_LEFT_SQUARES; i++) {
        tft_texture(square_black, leftBlackSquares[i].x, leftBlackSquares[i].y, 16);
        tft_texture(square_gray, leftGraySquares[i].x, leftGraySquares[i].y, 16);
        
    }
    
    // Affichage de la bande de droite
    for (i = 0; i < NB_RIGHT_SQUARES; i++) {
        tft_texture(square_black, rightBlackSquares[i].x, rightBlackSquares[i].y, 16);
        tft_texture(square_gray, rightGraySquares[i].x, rightGraySquares[i].y, 16);
        
    }
}

void start_falling_obj() {
    // Only generate object type if not already assigned
    if (fallingObject_type == -1) {
        fallingObject_type = rand_range(1, 5); // Randomly choose between 2 and 
    }
}

void update_falling_object() {
    
    if (fallingObject_type == 2) {
        tft_texture(argent, fallingObject_x, fallingObject_y, 16); // Display argent
    } else if (fallingObject_type == 3) {
        tft_texture(ananas, fallingObject_x, fallingObject_y, 16); // Display ananas
    }
    else if (fallingObject_type == 4){
        tft_texture(pizza, fallingObject_x, fallingObject_y, 16);
    }
    else if (fallingObject_type == 5){
         tft_texture(bombe, fallingObject_x, fallingObject_y, 16);
    }
    // Déplacer l'objet qui tombe
    if (fallingObject_y < 14) {
        fallingObject_y++;
    } else {
        fallingObject_type = -1;
        // Si l'objet atteint le bas de l'écran, il "tombe"
        if (fallingObject_x == Perso_x&fallingObject_type != 5) {
            score++;  // Si collectionné, augmenter le score
        } else {
           
        }
        
        // Réinitialiser l'objet tombant
        
        fallingObject_x = rand_range(5,14);
        fallingObject_y = 0;
    }   

}




 void update_score() {
   
     tft_disp_int(score,35,15,TFT_BLACK,TFT_BLUEE);
}   
 
 void update_time(){
     
      tft_disp_int(time,32,23,TFT_BLACK,TFT_BLUEE);
      tft_disp_int(1000,36,23,TFT_BLACK,TFT_BLUEE);
}   
 

void move_character()
{
        
       
             if (!_RA7 & Perso_x<14)
                 
         {  
            
             tft_texture(Perso_D,Perso_x+1,Perso_y,16); 
             tft_texture(clean_Perso,Perso_x,Perso_y,16);
             Perso_x++;
            
         }
         
            if (!_RA6&Perso_x>5)
        
         { 
             tft_texture(Perso_D,Perso_x-1,Perso_y,16); 
             tft_texture(clean_Perso,Perso_x,Perso_y,16);
             Perso_x--;
         }
         
            if (!_RA5&Perso_y<14)
        
         {   tft_texture(Perso_D,Perso_x,Perso_y+1,16); 
             tft_texture(clean_Perso,Perso_x,Perso_y,16);
             Perso_y++;
             
         }
         
            if (!_RA4&Perso_y>0)
        
         { 
             tft_texture(Perso_D,Perso_x,Perso_y-1,16); 
             tft_texture(clean_Perso,Perso_x,Perso_y,16);
             Perso_y--;
         }
    
}

/*a degager*/
void rand_falling_obj (){
    int object = rand_range(1,2) ;
    
    if (object ==1){
           tft_texture(argent,fallingObject_x,fallingObject_y,16);// gere l'affichage de l'objet tombant
    }
     else {     
         tft_texture(ananas,fallingObject_x,fallingObject_y,16);// gere l'affichage de l'objet tombant
     }
        
    
}

int main(void) {
        
       
       
       Fosc_init ();
       init_tmr3_interrupt(700000);
       srand_custom(TMR3);
       init_joystick(); // Initialization of the joystick
       tft_init(0);
       init_game();
     
        
       return 0;
      
}

void __attribute__((__interrupt__, no_auto_psv)) _T3Interrupt(void)
{

         for (;;)
    {   
         
        if (time==1000&score<20||(fallingObject_y == Perso_y&fallingObject_x == Perso_x&fallingObject_type == 5)){
                   tft_full(TFT_RED);
                 
                   for (;;) {
                         tft_char(15, 15,'G', TFT_BLACK, TFT_BLUEE);
                         tft_char(16, 15,'A', TFT_BLACK, TFT_BLUEE);
                         tft_char(17, 15,'M',  TFT_BLACK, TFT_BLUEE);
                         tft_char(18, 15,'E',  TFT_BLACK, TFT_BLUEE);
                         
                         tft_char(20, 15,'O',  TFT_BLACK, TFT_BLUEE);
                         tft_char(21, 15,'V', TFT_BLACK, TFT_BLUEE);
                         tft_char(22, 15,'E', TFT_BLACK, TFT_BLUEE);
                         tft_char(23, 15,'R',  TFT_BLACK, TFT_BLUEE);
                         
                        tft_char(15, 17,'S', TFT_BLACK, TFT_BLUEE);
                        tft_char(16, 17,'C', TFT_BLACK, TFT_BLUEE);
                        tft_char(17, 17,'O',  TFT_BLACK, TFT_BLUEE);
                        tft_char(18, 17,'R',  TFT_BLACK, TFT_BLUEE);
                        tft_char(19, 17,'E',  TFT_BLACK, TFT_BLUEE);
                        tft_char(20, 17,':',  TFT_BLACK, TFT_BLUEE);
                        tft_disp_int(score,21,17,TFT_BLACK,TFT_BLUEE);
                        
                        tft_char(15, 19,'P', TFT_BLACK, TFT_BLUEE);
                        tft_char(16, 19,'R', TFT_BLACK, TFT_BLUEE);
                        tft_char(17, 19,'E',  TFT_BLACK, TFT_BLUEE);
                        tft_char(18, 19,'S',  TFT_BLACK, TFT_BLUEE);
                        tft_char(19, 19,'S',  TFT_BLACK, TFT_BLUEE);
                     
                        tft_char(21, 19,'R', TFT_BLACK, TFT_BLUEE);
                        tft_char(22, 19,'A', TFT_BLACK, TFT_BLUEE);
                        tft_char(23, 19,'0',  TFT_BLACK, TFT_BLUEE);
                        tft_char(25, 19,'T',  TFT_BLACK, TFT_BLUEE);
                        tft_char(26, 19,'O',  TFT_BLACK, TFT_BLUEE);
                        tft_char(28, 19,'P',  TFT_BLACK, TFT_BLUEE);
                        tft_char(29, 19,'L',  TFT_BLACK, TFT_BLUEE);
                        tft_char(30, 19,'A', TFT_BLACK, TFT_BLUEE);
                        tft_char(31, 19,'Y', TFT_BLACK, TFT_BLUEE);
                        tft_char(33, 19,'A',  TFT_BLACK, TFT_BLUEE);
                        tft_char(34, 19,'G',  TFT_BLACK, TFT_BLUEE);
                        tft_char(35, 19,'A',  TFT_BLACK, TFT_BLUEE);
                        tft_char(36, 19,'I',  TFT_BLACK, TFT_BLUEE);
                        tft_char(37, 19,'N',  TFT_BLACK, TFT_BLUEE);
                        
                     
                         
                         if (_RA0==0){
                             init_game();
                             fallingObject_type=-1;
                             tft_full(TFT_BLACK);
                             break;
                         }
                        
                      
                   }
                   
      
         }      
         
        else if (time<=1000&score>=20){
                   tft_full(TFT_GREEN);
                 
                   for (;;) {
                         tft_char(15, 15,'T', TFT_BLACK, TFT_BLUEE);
                         tft_char(16, 15,'H', TFT_BLACK, TFT_BLUEE);
                         tft_char(17, 15,'A',  TFT_BLACK, TFT_BLUEE);
                         tft_char(18, 15,'T',  TFT_BLACK, TFT_BLUEE);
                         
                         tft_char(20, 15,'I',  TFT_BLACK, TFT_BLUEE);
                         tft_char(21, 15,'S', TFT_BLACK, TFT_BLUEE);
                         
                         tft_char(23, 15,'A', TFT_BLACK, TFT_BLUEE);
                         
                         tft_char(25, 15,'W',  TFT_BLACK, TFT_BLUEE);
                         tft_char(26, 15,'I', TFT_BLACK, TFT_BLUEE);
                         tft_char(27, 15,'N', TFT_BLACK, TFT_BLUEE);
                         
                        tft_char(15, 17,'S', TFT_BLACK, TFT_BLUEE);
                        tft_char(16, 17,'C', TFT_BLACK, TFT_BLUEE);
                        tft_char(17, 17,'O',  TFT_BLACK, TFT_BLUEE);
                        tft_char(18, 17,'R',  TFT_BLACK, TFT_BLUEE);
                        tft_char(19, 17,'E',  TFT_BLACK, TFT_BLUEE);
                         tft_char(20, 17,':',  TFT_BLACK, TFT_BLUEE);
                        
                        tft_disp_int(score,21,17,TFT_BLACK,TFT_BLUEE);
                         
                         if (_RD0==0){
                             init_game;
                         }
               
                         
                        
                   }
        }
        
          if(_RA15==0){
              for(;;){
                         tft_full (TFT_BLACK);
                         tft_char(15, 15,'G', TFT_BLACK, TFT_BLUEE);
                         tft_char(16, 15,'A', TFT_BLACK, TFT_BLUEE);
                         tft_char(17, 15,'M',  TFT_BLACK, TFT_BLUEE);
                         tft_char(18, 15,'E',  TFT_BLACK, TFT_BLUEE);
                         
                         tft_char(20, 15,'P',  TFT_BLACK, TFT_BLUEE);
                         tft_char(21, 15,'A', TFT_BLACK, TFT_BLUEE);
                         tft_char(22, 15,'U', TFT_BLACK, TFT_BLUEE);
                         tft_char(23, 15,'S',  TFT_BLACK, TFT_BLUEE);
                         tft_char(24, 15,'E', TFT_BLACK, TFT_BLUEE);
                         tft_char(25, 15,'D',  TFT_BLACK, TFT_BLUEE);
                         
                 
                        tft_char(15, 19,'P', TFT_BLACK, TFT_BLUEE);
                        tft_char(16, 19,'R', TFT_BLACK, TFT_BLUEE);
                        tft_char(17, 19,'E',  TFT_BLACK, TFT_BLUEE);
                        tft_char(18, 19,'S',  TFT_BLACK, TFT_BLUEE);
                        tft_char(19, 19,'S',  TFT_BLACK, TFT_BLUEE);
                     
                        tft_char(21, 19,'R', TFT_BLACK, TFT_BLUEE);
                        tft_char(22, 19,'A', TFT_BLACK, TFT_BLUEE);
                        tft_char(23, 19,'0',  TFT_BLACK, TFT_BLUEE);
                        tft_char(25, 19,'T',  TFT_BLACK, TFT_BLUEE);
                        tft_char(26, 19,'O',  TFT_BLACK, TFT_BLUEE);
                        tft_char(28, 19,'R',  TFT_BLACK, TFT_BLUEE);
                        tft_char(29, 19,'E',  TFT_BLACK, TFT_BLUEE);
                        tft_char(30, 19,'S', TFT_BLACK, TFT_BLUEE);
                        tft_char(31, 19,'U', TFT_BLACK, TFT_BLUEE);
                        tft_char(32, 19,'M',  TFT_BLACK, TFT_BLUEE);
                        tft_char(33, 19,'E',  TFT_BLACK, TFT_BLUEE);
                        
                  if (_RA0==0){
                  
                  break;
                  }
              }
          }
        
        
        time ++;     
        
        for (int i = 0; i < 768; i++) 
       {
            clean_Perso [i] = 255;
       }  
        move_character();
        scrolling_back();
        start_falling_obj();
        update_falling_object();
        update_score();
        update_time();
        tft_texture(Perso_D,Perso_x,Perso_y,16);  //Display a character at column Perso_x and Perso_y. Size of the character is 16Pixels X 16Pixels
        tft_texture_background();
       
    
        

        
        
         tft_full(TFT_BLUEE); //Coloring the screen with a unique color 
       
          
       /*tft_no_full(TFT_MAGENTA,320,16);// Coloring the ground*/
        /*tft_char(20, 29, 'A', 155, 0, 100, 0, 0, 0);
          tft_char(21, 29, 'R', 155, 0, 100, 0, 0, 0);
          tft_char(22, 29, 'I', 155, 0, 100, 0, 0, 0);
          tft_char(23, 29, 'S', 155, 0, 100, 0, 0, 0);*/

          tft_char(35, 9,  'S', TFT_BLACK, TFT_BLUEE);
          tft_char(35, 10,'C', TFT_BLACK, TFT_BLUEE);
          tft_char(35, 11,'O',  TFT_BLACK, TFT_BLUEE);
          tft_char(35, 12,'R',  TFT_BLACK, TFT_BLUEE);
          tft_char(35, 13,'E',  TFT_BLACK, TFT_BLUEE);
          
          tft_char(35, 18,'T', TFT_BLACK, TFT_BLUEE);
          tft_char(35, 19,'I', TFT_BLACK, TFT_BLUEE);
          tft_char(35, 20,'M',  TFT_BLACK, TFT_BLUEE);
          tft_char(35, 21,'E',  TFT_BLACK, TFT_BLUEE);
          tft_char(35, 23,'/',  TFT_BLACK, TFT_BLUEE);
 
         
        
          
          IFS0bits.T3IF = 0; //Clear Timer3 interrupt flag
       }    
     
        
}
    






